<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cortex â€“ Configuration</title><link>/docs/configuration/</link><description>Recent content in Configuration on Cortex</description><generator>Hugo -- gohugo.io</generator><atom:link href="/docs/configuration/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: Cortex Arguments</title><link>/docs/configuration/arguments/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/configuration/arguments/</guid><description>
&lt;h2 id=&#34;general-notes&#34;&gt;General Notes&lt;/h2&gt;
&lt;p&gt;Cortex has evolved over several years, and the command-line options sometimes reflect this heritage. In some cases the default value for options is not the recommended value, and in some cases names do not reflect the true meaning. We do intend to clean this up, but it requires a lot of care to avoid breaking existing installations. In the meantime we regret the inconvenience.&lt;/p&gt;
&lt;p&gt;Duration arguments should be specified with a unit like &lt;code&gt;5s&lt;/code&gt; or &lt;code&gt;3h&lt;/code&gt;. Valid time units are &amp;ldquo;ms&amp;rdquo;, &amp;ldquo;s&amp;rdquo;, &amp;ldquo;m&amp;rdquo;, &amp;ldquo;h&amp;rdquo;.&lt;/p&gt;
&lt;h2 id=&#34;querier&#34;&gt;Querier&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.max-concurrent&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The maximum number of top-level PromQL queries that will execute at the same time, per querier process.
If using the query frontend, this should be set to at least (&lt;code&gt;querier.worker-parallelism&lt;/code&gt; * number of query frontend replicas). Otherwise queries may queue in the queriers and not the frontend, which will affect QoS.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.query-parallelism&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This refers to database queries against the store (e.g. Bigtable or DynamoDB). This is the max subqueries run in parallel per higher-level query.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.timeout&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The timeout for a top-level PromQL query.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.max-samples&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Maximum number of samples a single query can load into memory, to avoid blowing up on enormous queries.&lt;/p&gt;
&lt;p&gt;The next three options only apply when the querier is used together with the Query Frontend:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.frontend-address&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Address of query frontend service, used by workers to find the frontend which will give them queries to execute.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.dns-lookup-period&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;How often the workers will query DNS to re-check where the frontend is.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.worker-parallelism&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Number of simultaneous queries to process, per worker process.
See note on &lt;code&gt;-querier.max-concurrent&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;querier-and-ruler&#34;&gt;Querier and Ruler&lt;/h2&gt;
&lt;p&gt;The ingester query API was improved over time, but defaults to the old behaviour for backwards-compatibility. For best results both of these next two flags should be set to &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.batch-iterators&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This uses iterators to execute query, as opposed to fully materialising the series in memory, and fetches multiple results per loop.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.ingester-streaming&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Use streaming RPCs to query ingester, to reduce memory pressure in the ingester.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.iterators&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is similar to &lt;code&gt;-querier.batch-iterators&lt;/code&gt; but less efficient.
If both &lt;code&gt;iterators&lt;/code&gt; and &lt;code&gt;batch-iterators&lt;/code&gt; are &lt;code&gt;true&lt;/code&gt;, &lt;code&gt;batch-iterators&lt;/code&gt; will take precedence.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-promql.lookback-delta&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Time since the last sample after which a time series is considered stale and ignored by expression evaluations.&lt;/p&gt;
&lt;h2 id=&#34;query-frontend&#34;&gt;Query Frontend&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.align-querier-with-step&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If set to true, will cause the query frontend to mutate incoming queries and align their start and end parameters to the step parameter of the query. This improves the cacheability of the query results.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.split-queries-by-day&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If set to true, will cause the query frontend to split multi-day queries into multiple single-day queries and execute them in parallel.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-querier.cache-results&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If set to true, will cause the querier to cache query results. The cache will be used to answer future, overlapping queries. The query frontend calculates extra queries required to fill gaps in the cache.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-frontend.max-cache-freshness&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When caching query results, it is desirable to prevent the caching of very recent results that might still be in flux. Use this parameter to configure the age of results that should be excluded.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-memcached.{hostname, service, timeout}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Use these flags to specify the location and timeout of the memcached cluster used to cache query results.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-redis.{endpoint, timeout}&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Use these flags to specify the location and timeout of the Redis service used to cache query results.&lt;/p&gt;
&lt;h2 id=&#34;distributor&#34;&gt;Distributor&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-distributor.shard-by-all-labels&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the original Cortex design, samples were sharded amongst distributors by the combination of (userid, metric name). Sharding by metric name was designed to reduce the number of ingesters you need to hit on the read path; the downside was that you could hotspot the write path.&lt;/p&gt;
&lt;p&gt;In hindsight, this seems like the wrong choice: we do many orders of magnitude more writes than reads, and ingester reads are in-memory and cheap. It seems the right thing to do is to use all the labels to shard, improving load balancing and support for very high cardinality metrics.&lt;/p&gt;
&lt;p&gt;Set this flag to &lt;code&gt;true&lt;/code&gt; for the new behaviour.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Upgrade notes&lt;/strong&gt;: As this flag also makes all queries always read from all ingesters, the upgrade path is pretty trivial; just enable the flag. When you do enable it, you&amp;rsquo;ll see a spike in the number of active series as the writes are &amp;ldquo;reshuffled&amp;rdquo; amongst the ingesters, but over the next stale period all the old series will be flushed, and you should end up with much better load balancing. With this flag enabled in the queriers, reads will always catch all the data from all ingesters.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;-distributor.extra-query-delay&lt;/code&gt;
This is used by a component with an embedded distributor (Querier and Ruler) to control how long to wait until sending more than the minimum amount of queries needed for a successful response.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;distributor.ha-tracker.enable-for-all-users&lt;/code&gt;
Flag to enable, for all users, handling of samples with external labels identifying replicas in an HA Prometheus setup. This defaults to false, and is technically defined in the Distributor limits.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;distributor.ha-tracker.enable&lt;/code&gt;
Enable the distributors HA tracker so that it can accept samples from Prometheus HA replicas gracefully (requires labels). Global (for distributors), this ensures that the necessary internal data structures for the HA handling are created. The option &lt;code&gt;enable-for-all-users&lt;/code&gt; is still needed to enable ingestion of HA samples for all users.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;distributor.drop-label&lt;/code&gt;
This flag can be used to specify label names that to drop during sample ingestion within the distributor and can be repeated in order to drop multiple labels.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ring-ha-tracker-store&#34;&gt;Ring/HA Tracker Store&lt;/h3&gt;
&lt;p&gt;The KVStore client is used by both the Ring and HA Tracker.
- &lt;code&gt;{ring,distributor.ha-tracker}.prefix&lt;/code&gt;
The prefix for the keys in the store. Should end with a /. For example with a prefix of foo/, the key bar would be stored under foo/bar.
- &lt;code&gt;{ring,distributor.ha-tracker}.store&lt;/code&gt;
Backend storage to use for the ring (consul, etcd, inmemory, memberlist, multi).&lt;/p&gt;
&lt;h4 id=&#34;consul&#34;&gt;Consul&lt;/h4&gt;
&lt;p&gt;By default these flags are used to configure Consul used for the ring. To configure Consul for the HA tracker,
prefix these flags with &lt;code&gt;distributor.ha-tracker.&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;consul.hostname&lt;/code&gt;
Hostname and port of Consul.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;consul.acltoken&lt;/code&gt;
ACL token used to interact with Consul.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;consul.client-timeout&lt;/code&gt;
HTTP timeout when talking to Consul.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;consul.consistent-reads&lt;/code&gt;
Enable consistent reads to Consul.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;etcd&#34;&gt;etcd&lt;/h4&gt;
&lt;p&gt;By default these flags are used to configure etcd used for the ring. To configure etcd for the HA tracker,
prefix these flags with &lt;code&gt;distributor.ha-tracker.&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;etcd.endpoints&lt;/code&gt;
The etcd endpoints to connect to.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;etcd.dial-timeout&lt;/code&gt;
The timeout for the etcd connection.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;etcd.max-retries&lt;/code&gt;
The maximum number of retries to do for failed ops.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;memberlist-experimental&#34;&gt;memberlist (EXPERIMENTAL)&lt;/h4&gt;
&lt;p&gt;Flags for configuring KV store based on memberlist library. This feature is experimental, please don&amp;rsquo;t use it yet.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;memberlist.nodename&lt;/code&gt;
Name of the node in memberlist cluster. Defaults to hostname.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.retransmit-factor&lt;/code&gt;
Multiplication factor used when sending out messages (factor * log(N+1)). If not set, default value is used.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.join&lt;/code&gt;
Other cluster members to join. Can be specified multiple times.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.abort-if-join-fails&lt;/code&gt;
If this node fails to join memberlist cluster, abort.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.left-ingesters-timeout&lt;/code&gt;
How long to keep LEFT ingesters in the ring. Note: this is only used for gossiping, LEFT ingesters are otherwise invisible.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.leave-timeout&lt;/code&gt;
Timeout for leaving memberlist cluster.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.gossip-interval&lt;/code&gt;
How often to gossip with other cluster members. Uses memberlist LAN defaults if 0.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.gossip-nodes&lt;/code&gt;
How many nodes to gossip with in each gossip interval. Uses memberlist LAN defaults if 0.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.pullpush-interval&lt;/code&gt;
How often to use pull/push sync. Uses memberlist LAN defaults if 0.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.bind-addr&lt;/code&gt;
IP address to listen on for gossip messages. Multiple addresses may be specified. Defaults to 0.0.0.0.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.bind-port&lt;/code&gt;
Port to listen on for gossip messages. Defaults to 7946.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.packet-dial-timeout&lt;/code&gt;
Timeout used when connecting to other nodes to send packet.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.packet-write-timeout&lt;/code&gt;
Timeout for writing &amp;lsquo;packet&amp;rsquo; data.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;memberlist.transport-debug&lt;/code&gt;
Log debug transport messages. Note: global log.level must be at debug level as well.
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;multi-kv&#34;&gt;Multi KV&lt;/h4&gt;
&lt;p&gt;This is a special key-value implementation that uses two different KV stores (eg. consul, etcd or memberlist). One of them is always marked as primary, and all reads and writes go to primary store. Other one, secondary, is only used for writes. The idea is that operator can use multi KV store to migrate from primary to secondary store in runtime.&lt;/p&gt;
&lt;p&gt;For example, migration from Consul to Etcd would look like this:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Set &lt;code&gt;ring.store&lt;/code&gt; to use &lt;code&gt;multi&lt;/code&gt; store. Set &lt;code&gt;-multi.primary=consul&lt;/code&gt; and &lt;code&gt;-multi.secondary=etcd&lt;/code&gt;. All consul and etcd settings must still be specified.&lt;/li&gt;
&lt;li&gt;Start all Cortex microservices. They will still use Consul as primary KV, but they will also write share ring via etcd.&lt;/li&gt;
&lt;li&gt;Operator can now use &amp;ldquo;runtime config&amp;rdquo; mechanism to switch primary store to etcd.&lt;/li&gt;
&lt;li&gt;After all Cortex microservices have picked up new primary store, and everything looks correct, operator can now shut down Consul, and modify Cortex configuration to use &lt;code&gt;-ring.store=etcd&lt;/code&gt; only.&lt;/li&gt;
&lt;li&gt;At this point, Consul can be shut down.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Multi KV has following parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;multi.primary&lt;/code&gt; - name of primary KV store. Same values as in &lt;code&gt;ring.store&lt;/code&gt; are supported, except &lt;code&gt;multi&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;multi.secondary&lt;/code&gt; - name of secondary KV store.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;multi.mirror-enabled&lt;/code&gt; - enable mirroring of values to secondary store, defaults to true&lt;/li&gt;
&lt;li&gt;&lt;code&gt;multi.mirror-timeout&lt;/code&gt; - wait max this time to write to secondary store to finish. Default to 2 seconds. Errors writing to secondary store are not reported to caller, but are logged and also reported via &lt;code&gt;cortex_multikv_mirror_write_errors_total&lt;/code&gt; metric.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Multi KV also reacts on changes done via runtime configuration. It uses this section:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;multi_kv_config&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;mirror-enabled&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;primary&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;memberlist&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note that runtime configuration values take precedence over command line options.&lt;/p&gt;
&lt;h3 id=&#34;ha-tracker&#34;&gt;HA Tracker&lt;/h3&gt;
&lt;p&gt;HA tracking has two of its own flags:
- &lt;code&gt;distributor.ha-tracker.cluster&lt;/code&gt;
Prometheus label to look for in samples to identify a Prometheus HA cluster. (default &amp;ldquo;cluster&amp;rdquo;)
- &lt;code&gt;distributor.ha-tracker.replica&lt;/code&gt;
Prometheus label to look for in samples to identify a Prometheus HA replica. (default &amp;ldquo;&lt;code&gt;__replica__&lt;/code&gt;&amp;rdquo;)&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s reasonable to assume people probably already have a &lt;code&gt;cluster&lt;/code&gt; label, or something similar. If not, they should add one along with &lt;code&gt;__replica__&lt;/code&gt; via external labels in their Prometheus config. If you stick to these default values your Prometheus config could look like this (&lt;code&gt;POD_NAME&lt;/code&gt; is an environment variable which must be set by you):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;global&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;external_labels&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;cluster&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;clustername&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;__replica__&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;$POD_NAME&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;HA Tracking looks for the two labels (which can be overwritten per user)&lt;/p&gt;
&lt;p&gt;It also talks to a KVStore and has it&amp;rsquo;s own copies of the same flags used by the Distributor to connect to for the ring.
- &lt;code&gt;distributor.ha-tracker.failover-timeout&lt;/code&gt;
If we don&amp;rsquo;t receive any samples from the accepted replica for a cluster in this amount of time we will failover to the next replica we receive a sample from. This value must be greater than the update timeout (default 30s)
- &lt;code&gt;distributor.ha-tracker.store&lt;/code&gt;
Backend storage to use for the ring (consul, etcd, inmemory). (default &amp;ldquo;consul&amp;rdquo;)
- &lt;code&gt;distributor.ha-tracker.update-timeout&lt;/code&gt;
Update the timestamp in the KV store for a given cluster/replica only after this amount of time has passed since the current stored timestamp. (default 15s)&lt;/p&gt;
&lt;h2 id=&#34;ingester&#34;&gt;Ingester&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester.max-chunk-age&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The maximum duration of a timeseries chunk in memory. If a timeseries runs for longer than this the current chunk will be flushed to the store and a new chunk created. (default 12h)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester.max-chunk-idle&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If a series doesn&amp;rsquo;t receive a sample for this duration, it is flushed and removed from memory.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester.max-stale-chunk-idle&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If a series receives a &lt;a href=&#34;https://www.robustperception.io/staleness-and-promql&#34;&gt;staleness marker&lt;/a&gt;, then we wait for this duration to get another sample before we close and flush this series, removing it from memory. You want it to be at least 2x the scrape interval as you don&amp;rsquo;t want a single failed scrape to cause a chunk flush.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester.chunk-age-jitter&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To reduce load on the database exactly 12 hours after starting, the age limit is reduced by a varying amount up to this. (default 20m)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester.spread-flushes&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Makes the ingester flush each timeseries at a specific point in the &lt;code&gt;max-chunk-age&lt;/code&gt; cycle. This means multiple replicas of a chunk are very likely to contain the same contents which cuts chunk storage space by up to 66%. Set &lt;code&gt;-ingester.chunk-age-jitter&lt;/code&gt; to &lt;code&gt;0&lt;/code&gt; when using this option. If a chunk cache is configured (via &lt;code&gt;-memcached.hostname&lt;/code&gt;) then duplicate chunk writes are skipped which cuts write IOPs.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester.join-after&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;How long to wait in PENDING state during the &lt;a href=&#34;/docs/guides/ingester-handover/&#34;&gt;hand-over process&lt;/a&gt;. (default 0s)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester.max-transfer-retries&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;How many times a LEAVING ingester tries to find a PENDING ingester during the &lt;a href=&#34;/docs/guides/ingester-handover/&#34;&gt;hand-over process&lt;/a&gt;. Each attempt takes a second or so. Negative value or zero disables hand-over process completely. (default 10)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester.normalise-tokens&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Deprecated. New ingesters always write &amp;ldquo;normalised&amp;rdquo; tokens to the ring. Normalised tokens consume less memory to encode and decode; as the ring is unmarshalled regularly, this significantly reduces memory usage of anything that watches the ring.&lt;/p&gt;
&lt;p&gt;Cortex 0.4.0 is the last version that can &lt;em&gt;write&lt;/em&gt; denormalised tokens. Cortex 0.5.0 and later will always &lt;em&gt;write&lt;/em&gt; normalised tokens, although it can still &lt;em&gt;read&lt;/em&gt; denormalised tokens written by older ingesters.&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s perfectly OK to have a mix of ingesters running denormalised (&amp;lt;= 0.4.0) and normalised tokens (either by using &lt;code&gt;-ingester.normalise-tokens&lt;/code&gt; in Cortex &amp;lt;= 0.4.0, or Cortex 0.5.0+) during upgrades.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester.chunk-encoding&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Pick one of the encoding formats for timeseries data, which have different performance characteristics.
&lt;code&gt;Bigchunk&lt;/code&gt; uses the Prometheus V2 code, and expands in memory to arbitrary length.
&lt;code&gt;Varbit&lt;/code&gt;, &lt;code&gt;Delta&lt;/code&gt; and &lt;code&gt;DoubleDelta&lt;/code&gt; use Prometheus V1 code, and are fixed at 1K per chunk.
Defaults to &lt;code&gt;DoubleDelta&lt;/code&gt;, but we recommend &lt;code&gt;Bigchunk&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-store.bigchunk-size-cap-bytes&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When using bigchunks, start a new bigchunk and flush the old one if the old one reaches this size. Use this setting to limit memory growth of ingesters with a lot of timeseries that last for days.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester-client.expected-timeseries&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When &lt;code&gt;push&lt;/code&gt; requests arrive, pre-allocate this many slots to decode them. Tune this setting to reduce memory allocations and garbage. This should match the &lt;code&gt;max_samples_per_send&lt;/code&gt; in your &lt;code&gt;queue_config&lt;/code&gt; for Prometheus.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester-client.expected-samples-per-series&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When &lt;code&gt;push&lt;/code&gt; requests arrive, pre-allocate this many slots to decode them. Tune this setting to reduce memory allocations and garbage. Under normal conditions, Prometheus scrapes should arrive with one sample per series.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-ingester-client.expected-labels&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When &lt;code&gt;push&lt;/code&gt; requests arrive, pre-allocate this many slots to decode them. Tune this setting to reduce memory allocations and garbage. The optimum value will depend on how many labels are sent with your timeseries samples.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-store.chunk-cache-stubs&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Where you don&amp;rsquo;t want to cache every chunk written by ingesters, but you do want to take advantage of chunk write deduplication, this option will make ingesters write a placeholder to the cache for each chunk.
Make sure you configure ingesters with a different cache to queriers, which need the whole value.&lt;/p&gt;
&lt;h2 id=&#34;runtime-configuration-file&#34;&gt;Runtime Configuration file&lt;/h2&gt;
&lt;p&gt;Cortex has a concept of &amp;ldquo;runtime config&amp;rdquo; file, which is simply a file that is reloaded while Cortex is running. It is used by some Cortex components to allow operator to change some aspects of Cortex configuration without restarting it. File is specified by using &lt;code&gt;-runtime-config.file=&amp;lt;filename&amp;gt;&lt;/code&gt; flag and reload period (which defaults to 10 seconds) can be changed by &lt;code&gt;-runtime-config.reload-period=&amp;lt;duration&amp;gt;&lt;/code&gt; flag. Previously this mechanism was only used by limits overrides, and flags were called &lt;code&gt;-limits.per-user-override-config=&amp;lt;filename&amp;gt;&lt;/code&gt; and &lt;code&gt;-limits.per-user-override-period=10s&lt;/code&gt; respectively. These are still used, if &lt;code&gt;-runtime-config.file=&amp;lt;filename&amp;gt;&lt;/code&gt; is not specified.&lt;/p&gt;
&lt;p&gt;At the moment, two components use runtime configuration: limits and multi KV store.&lt;/p&gt;
&lt;p&gt;Example runtime configuration file:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;overrides&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;tenant1&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;ingestion_rate&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;10000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_series_per_metric&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_series_per_query&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;tenant2&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_samples_per_query&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1000000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_series_per_metric&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_series_per_query&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;multi_kv_config&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;mirror-enabled&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;primary&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;memberlist&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When running Cortex on Kubernetes, store this file in a config map and mount it in each services&amp;rsquo; containers. When changing the values there is no need to restart the services, unless otherwise specified.&lt;/p&gt;
&lt;h2 id=&#34;ingester-distributor-querier-limits&#34;&gt;Ingester, Distributor &amp;amp; Querier limits.&lt;/h2&gt;
&lt;p&gt;Cortex implements various limits on the requests it can process, in order to prevent a single tenant overwhelming the cluster. There are various default global limits which apply to all tenants which can be set on the command line. These limits can also be overridden on a per-tenant basis by using &lt;code&gt;overrides&lt;/code&gt; field of runtime configuration file.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;overrides&lt;/code&gt; field is a map of tenant ID (same values as passed in the &lt;code&gt;X-Scope-OrgID&lt;/code&gt; header) to the various limits. An example could look like:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;overrides&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;tenant1&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;ingestion_rate&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;10000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_series_per_metric&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_series_per_query&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;tenant2&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_samples_per_query&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1000000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_series_per_metric&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_series_per_query&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100000&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Valid per-tenant limits are (with their corresponding flags for default values):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ingestion_rate_strategy&lt;/code&gt; / &lt;code&gt;-distributor.ingestion-rate-limit-strategy&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ingestion_rate&lt;/code&gt; / &lt;code&gt;-distributor.ingestion-rate-limit&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ingestion_burst_size&lt;/code&gt; / &lt;code&gt;-distributor.ingestion-burst-size&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The per-tenant rate limit (and burst size), in samples per second. It supports two strategies: &lt;code&gt;local&lt;/code&gt; (default) and &lt;code&gt;global&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;local&lt;/code&gt; strategy enforces the limit on a per distributor basis, actual effective rate limit will be N times higher, where N is the number of distributor replicas.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;global&lt;/code&gt; strategy enforces the limit globally, configuring a per-distributor local rate limiter as &lt;code&gt;ingestion_rate / N&lt;/code&gt;, where N is the number of distributor replicas (it&amp;rsquo;s automatically adjusted if the number of replicas change). The &lt;code&gt;ingestion_burst_size&lt;/code&gt; refers to the per-distributor local rate limiter (even in the case of the &lt;code&gt;global&lt;/code&gt; strategy) and should be set at least to the maximum number of samples expected in a single push request. For this reason, the &lt;code&gt;global&lt;/code&gt; strategy requires that push requests are evenly distributed across the pool of distributors; if you use a load balancer in front of the distributors you should be already covered, while if you have a custom setup (ie. an authentication gateway in front) make sure traffic is evenly balanced across distributors.&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;global&lt;/code&gt; strategy requires the distributors to form their own ring, which is used to keep track of the current number of healthy distributor replicas. The ring is configured by &lt;code&gt;distributor: { ring: {}}&lt;/code&gt; / &lt;code&gt;-distributor.ring.*&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;max_label_name_length&lt;/code&gt; / &lt;code&gt;-validation.max-length-label-name&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;max_label_value_length&lt;/code&gt; / &lt;code&gt;-validation.max-length-label-value&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;max_label_names_per_series&lt;/code&gt; / &lt;code&gt;-validation.max-label-names-per-series&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Also enforced by the distributor, limits on the on length of labels and their values, and the total number of labels allowed per series.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;reject_old_samples&lt;/code&gt; / &lt;code&gt;-validation.reject-old-samples&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;reject_old_samples_max_age&lt;/code&gt; / &lt;code&gt;-validation.reject-old-samples.max-age&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;creation_grace_period&lt;/code&gt; / &lt;code&gt;-validation.create-grace-period&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Also enforce by the distributor, limits on how far in the past (and future) timestamps that we accept can be.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;max_series_per_user&lt;/code&gt; / &lt;code&gt;-ingester.max-series-per-user&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;max_series_per_metric&lt;/code&gt; / &lt;code&gt;-ingester.max-series-per-metric&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Enforced by the ingesters; limits the number of active series a user (or a given metric) can have. When running with &lt;code&gt;-distributor.shard-by-all-labels=false&lt;/code&gt; (the default), this limit will enforce the maximum number of series a metric can have &amp;lsquo;globally&amp;rsquo;, as all series for a single metric will be sent to the same replication set of ingesters. This is not the case when running with &lt;code&gt;-distributor.shard-by-all-labels=true&lt;/code&gt;, so the actual limit will be N/RF times higher, where N is number of ingester replicas and RF is configured replication factor.&lt;/p&gt;
&lt;p&gt;An active series is a series to which a sample has been written in the last &lt;code&gt;-ingester.max-chunk-idle&lt;/code&gt; duration, which defaults to 5 minutes.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;max_global_series_per_user&lt;/code&gt; / &lt;code&gt;-ingester.max-global-series-per-user&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;max_global_series_per_metric&lt;/code&gt; / &lt;code&gt;-ingester.max-global-series-per-metric&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Like &lt;code&gt;max_series_per_user&lt;/code&gt; and &lt;code&gt;max_series_per_metric&lt;/code&gt;, but the limit is enforced across the cluster. Each ingester is configured with a local limit based on the replication factor, the &lt;code&gt;-distributor.shard-by-all-labels&lt;/code&gt; setting and the current number of healthy ingesters, and is kept updated whenever the number of ingesters change.&lt;/p&gt;
&lt;p&gt;Requires &lt;code&gt;-distributor.replication-factor&lt;/code&gt; and &lt;code&gt;-distributor.shard-by-all-labels&lt;/code&gt; set for the ingesters too.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;max_series_per_query&lt;/code&gt; / &lt;code&gt;-ingester.max-series-per-query&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;max_samples_per_query&lt;/code&gt; / &lt;code&gt;-ingester.max-samples-per-query&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Limits on the number of timeseries and samples returns by a single ingester during a query.&lt;/p&gt;
&lt;h2 id=&#34;storage&#34;&gt;Storage&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;s3.force-path-style&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Set this to &lt;code&gt;true&lt;/code&gt; to force the request to use path-style addressing (&lt;code&gt;http://s3.amazonaws.com/BUCKET/KEY&lt;/code&gt;). By default, the S3 client will use virtual hosted bucket addressing when possible (&lt;code&gt;http://BUCKET.s3.amazonaws.com/KEY&lt;/code&gt;).&lt;/p&gt;</description></item><item><title>Docs: Prometheus Frontend</title><link>/docs/configuration/prometheus-frontend/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/configuration/prometheus-frontend/</guid><description>
&lt;p&gt;You can use the Cortex query frontend with any Prometheus-API compatible
service, including Prometheus and Thanos. Use this config file to get
the benefits of query parallelisation and caching.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Disable the requirement that every request to Cortex has a&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# X-Scope-OrgID header. `fake` will be substituted in instead.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;auth_enabled&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# We only want to run the query-frontend module.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;target&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;query-frontend&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# We don&amp;#39;t want the usual /api/prom prefix.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;http_prefix&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;server&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;http_listen_port&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;9091&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;query_range&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;split_queries_by_day&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;align_queries_with_step&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;cache_results&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;results_cache&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_freshness&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;1m&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;cache&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# We&amp;#39;re going to use the in-process &amp;#34;FIFO&amp;#34; cache, but you can enable&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# memcached below.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;enable_fifocache&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;fifocache&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;size&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1024&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;validity&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;24h&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# If you want to use a memcached cluster, configure a headless service&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# in Kubernetes and Cortex will discover the individual instances using&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# a SRV DNS query. Cortex will then do client-side hashing to spread&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# the load evenly.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# memcached:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# memcached_client:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# host: memcached.default.svc.cluster.local&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# service: memcached&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# consistent_hash: true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;frontend&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;log_queries_longer_than&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;1s&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;compress_responses&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item><item><title>Docs: Single-process</title><link>/docs/configuration/single-process-config/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>/docs/configuration/single-process-config/</guid><description>
&lt;p&gt;Configuration for running Cortex in single-process mode.
This should not be used in production. It is only for getting started
and development.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Disable the requirement that every request to Cortex has a&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# X-Scope-OrgID header. `fake` will be substituted in instead.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;auth_enabled&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;server&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;http_listen_port&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;9009&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Configure the server to allow messages up to 100MB.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;grpc_server_max_recv_msg_size&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;104857600&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;grpc_server_max_send_msg_size&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;104857600&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;grpc_server_max_concurrent_streams&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1000&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;distributor&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;shard_by_all_labels&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;pool&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;health_check_ingesters&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;ingester_client&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;grpc_client_config&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Configure the client to allow messages up to 100MB.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_recv_msg_size&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;104857600&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;max_send_msg_size&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;104857600&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;use_gzip_compression&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;ingester&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;#chunk_idle_period: 15m&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;lifecycler&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The address to advertise for this ingester. Will be autodiscovered by&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# looking up address on eth0 or en0; can be specified if this fails.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# address: 127.0.0.1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# We want to start immediately and flush on shutdown.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;join_after&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;claim_on_rollout&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;final_sleep&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;0s&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;num_tokens&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;512&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Use an in memory ring store, so we don&amp;#39;t need to launch a Consul.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;ring&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;kvstore&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;store&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;inmemory&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;replication_factor&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Use local storage - BoltDB for the index, and the filesystem&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# for the chunks.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;schema&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;configs&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;from&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;2019-07-29&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;store&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;boltdb&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;object_store&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;filesystem&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;schema&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;v10&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;index&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;prefix&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;index_&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;period&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;168h&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;storage&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;boltdb&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;directory&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;/tmp/cortex/index&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;filesystem&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;directory&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;/tmp/cortex/chunks&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description></item></channel></rss>